<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>IG Follow Manager PRO</title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  
  <!-- HEADER -->
  <header>
    <div class="header-content">
      <h1>IG Manager <span class="badge-pro">PRO</span></h1>
      <div class="header-actions">
        <button id="btn-reset" class="btn-icon-text" title="Borrar datos y reiniciar">
          ğŸ”„ Reiniciar
        </button>
        <div id="status-indicator" class="status-dot" title="Desconectado"></div>
      </div>
    </div>
  </header>

  <!-- TABS -->
  <nav class="tabs">
    <button class="tab-btn active" data-tab="connect">
      <span class="icon">ğŸ”Œ</span> ConexiÃ³n
    </button>
    <button class="tab-btn" data-tab="data">
      <span class="icon">ğŸ’¾</span> Datos
    </button>
    <button class="tab-btn" data-tab="analyze">
      <span class="icon">ğŸ“Š</span> AnÃ¡lisis
    </button>
  </nav>

  <!-- MAIN CONTENT -->
  <main>
    
    <!-- TAB 1: CONEXIÃ“N -->
    <section id="connect" class="content active">
      <div class="card">
        <h3>1. Conectar con Instagram</h3>
        <p class="helper-text">Pega el cÃ³digo 'fetch' desde la pestaÃ±a Network de las herramientas de desarrollador.</p>
        <div class="input-group">
          <textarea id="fetch-input" placeholder='fetch("https://www.instagram.com/api/v1/friendships/...'></textarea>
        </div>
        <button id="btn-connect" class="btn btn-primary full-width">ğŸ”— Conectar API</button>
        <div id="connection-msg" class="alert hidden"></div>
      </div>

      <div class="card">
        <h3>2. Descargar Datos</h3>
        <p class="helper-text">ObtÃ©n tus listas actuales directamente desde la API.</p>
        <div class="grid-2">
          <button id="btn-fetch-followers" class="btn btn-blue" disabled>
            â¬‡ Seguidores
            <span class="tooltip">Descarga tu lista de seguidores</span>
          </button>
          <button id="btn-fetch-following" class="btn btn-purple" disabled>
            â¬‡ Seguidos
            <span class="tooltip">Descarga a quiÃ©n sigues</span>
          </button>
        </div>
        
        <!-- Progress Bar -->
        <div class="progress-container hidden" id="api-progress">
          <div class="progress-bar"><div class="progress-fill" style="width: 0%"></div></div>
          <div class="progress-text">Procesando...</div>
        </div>
      </div>
    </section>

    <!-- TAB 2: DATOS -->
    <section id="data" class="content">
      <div class="stats-container">
        <div class="stat-card blue">
          <span class="stat-value" id="count-followers">0</span>
          <span class="stat-label">Seguidores</span>
        </div>
        <div class="stat-card purple">
          <span class="stat-value" id="count-following">0</span>
          <span class="stat-label">Seguidos</span>
        </div>
      </div>

      <div class="card">
        <h3>Importar / Exportar</h3>
        <p class="helper-text">Gestiona tus archivos CSV locales.</p>
        
        <div class="action-row">
          <div class="file-input-wrapper">
            <button class="btn btn-outline-blue small">ğŸ“‚ Cargar Followers</button>
            <input type="file" id="file-followers" accept=".csv">
          </div>
          <button id="btn-export-followers" class="btn btn-text small" disabled>ğŸ’¾ Guardar CSV</button>
        </div>

        <div class="action-row">
          <div class="file-input-wrapper">
            <button class="btn btn-outline-purple small">ğŸ“‚ Cargar Following</button>
            <input type="file" id="file-following" accept=".csv">
          </div>
          <button id="btn-export-following" class="btn btn-text small" disabled>ğŸ’¾ Guardar CSV</button>
        </div>
      </div>
    </section>

    <!-- TAB 3: ANÃLISIS -->
    <section id="analyze" class="content">
      <div class="card highlight-card">
        <h3>Comparar Listas</h3>
        <p class="helper-text">Descubre quiÃ©n no te sigue de vuelta.</p>
        <button id="btn-compare" class="btn btn-orange full-width" disabled>ğŸ” Analizar Diferencias</button>
      </div>

      <div id="analysis-results" class="hidden">
        <div class="results-header">
          <h3>No te siguen: <span id="non-followers-count" class="count-badge">0</span></h3>
          <button id="btn-export-non-followers" class="btn btn-outline-orange small">ğŸ’¾ Exportar CSV</button>
        </div>

        <!-- Unfollow Actions -->
        <div class="unfollow-actions">
          <p class="section-title">Acciones Masivas</p>
          
          <div class="grid-2">
            <button id="btn-unfollow-common" class="btn btn-danger-soft">
              ğŸ›¡ï¸ Unfollow Comunes
              <span class="tooltip">Excluye verificados, creadores y VIPs</span>
            </button>
            
            <button id="btn-unfollow-all" class="btn btn-danger-hard">
              ğŸ’€ Unfollow TODOS
              <span class="tooltip">Â¡Peligro! Borra a todos sin excepciÃ³n</span>
            </button>
          </div>
        </div>

        <!-- Table Container -->
        <div id="table-container" class="table-wrapper"></div>
        
        <!-- Unfollow Progress -->
        <div class="progress-container hidden" id="unfollow-progress">
          <div class="progress-bar red"><div class="progress-fill" style="width: 0%"></div></div>
          <div class="progress-text">Eliminando...</div>
        </div>
      </div>
    </section>

  </main>

  <!-- MODAL CONFIRMATION -->
  <div id="confirm-modal" class="modal hidden">
    <div class="modal-content">
      <h3 id="modal-title">Â¿EstÃ¡s seguro?</h3>
      <p id="modal-desc">Esta acciÃ³n dejarÃ¡ de seguir a X personas.</p>
      <div class="modal-actions">
        <button id="modal-cancel" class="btn btn-secondary">Cancelar</button>
        <button id="modal-confirm" class="btn btn-danger">Confirmar</button>
      </div>
    </div>
  </div>

  <script type="module" src="popup.js"></script>
</body>
</html>
